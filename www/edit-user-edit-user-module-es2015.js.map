{"version":3,"sources":["./src/app/edit-user/edit-user-routing.module.ts","./src/app/edit-user/edit-user.module.ts","./src/app/shared-modules/shared-modules.module.ts","./src/app/edit-user/edit-user.page.ts","./src/app/edit-user/edit-user.page.scss","./src/app/edit-user/edit-user.page.html"],"names":[],"mappings":"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","file":"edit-user-edit-user-module-es2015.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { EditUserPage } from './edit-user.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: EditUserPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class EditUserPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { IonicModule } from '@ionic/angular';\nimport { EditUserPageRoutingModule } from './edit-user-routing.module';\nimport { EditUserPage } from './edit-user.page';\nimport { SharedModulesModule } from '../shared-modules/shared-modules.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    EditUserPageRoutingModule,\n    FormsModule,\n    ReactiveFormsModule,\n    SharedModulesModule\n  ],\n  declarations: [EditUserPage]\n})\nexport class EditUserPageModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { HeaderComponent } from '../header/header.component';\nimport { RouterModule } from '@angular/router';\n\n\n@NgModule({\n  declarations: [HeaderComponent],\n  imports: [\n    CommonModule,\n    RouterModule\n  ],\n  exports:[HeaderComponent]\n})\nexport class SharedModulesModule { }\n","import { Component, OnInit, SimpleChanges } from '@angular/core';\nimport { FormBuilder, FormGroup } from '@angular/forms';\nimport { ActivatedRoute } from '@angular/router';\nimport { NavController, ToastController } from '@ionic/angular';\nimport { CantiniereAPIService } from '../cantiniere-api.service';\nimport { User } from '../model/User';\nimport { EmailUtils } from '../utils/EmailUtils';\nimport { ToastUtils } from '../utils/ToastUtils';\n\n@Component({\n  selector: 'app-edit-user',\n  templateUrl: './edit-user.page.html',\n  styleUrls: ['./edit-user.page.scss'],\n})\nexport class EditUserPage implements OnInit {\n\n  constructor(private formBuilder: FormBuilder, private service: CantiniereAPIService, private toastController: ToastController, private route: ActivatedRoute, private navController: NavController) {}\n\n  token: string\n  user\n  userForm: FormGroup\n  isValidateEnabled: boolean = false\n  isImageImported: boolean = false\n  image64: string\n\n  ngOnInit() {\n\n    // User et Token recupéré depuis la sessionStorage\n    // ils existent forcement car on ne peut acceder à cette page que si on est connecté\n    this.user = JSON.parse(sessionStorage.getItem(\"User\"))\n    this.token = sessionStorage.getItem(\"JWT\")\n\n    //let userId = this.route.snapshot.paramMap.get(\"id\")\n\n    this.userForm = this.formBuilder.group({\n      email: this.user.email,\n      verifyEmail: this.user.email,\n      address: this.user.address,\n      phone: this.user.phone\n    })\n\n    this.userForm.valueChanges.subscribe(values => {\n      \n      if(values.email != \"\" && values.verifyEmail != \"\" && values.adress != \"\" && values.phone != null){\n        this.isValidateEnabled = true\n      } else this.isValidateEnabled = false\n\n    })\n  }\n\n  // executée quand l'image est importée par l'utilisateur\n  onImageUploaded(event: any) {\n    const image = event.target.files[0]\n\n    let sizeMB = image.size / 1000000\n\n    if(sizeMB < 5){\n\n      this.getImage64(image)\n      this.isImageImported = true\n\n    } else ToastUtils.presentToast(\"Veuillez importer une image inférieure à 5MB\", \"danger\", this.toastController)\n\n  }\n\n  getImage64(file :any){\n    let reader = new FileReader()\n\n    reader.readAsDataURL(file)\n\n    reader.onload = (result) => {\n        this.image64 = String(result.target.result)\n    }\n\n    reader.onerror = (error) => {\n        ToastUtils.presentToast(\"Une erreur s'est produite lors de l'import de l'image\", \"danger\", this.toastController)\n    }\n  }\n\n  // executée quand l'utilisateur clique sur modifier avatar\n  uploadImage(){\n    \n    // desactivation du bouton au click \n    this.isImageImported = false\n\n    this.service.updateUserImg(this.user.id, this.image64, this.token).subscribe((response) => {\n      \n      console.log(response)\n\n      this.service.findImg(this.user.id, this.token).subscribe((response) => {\n        console.log(response)\n        //this.user.image.imagePath = response.body.imagePath\n      })\n\n      //this.navController.pop()\n    }, (error) => {\n      console.log(error)\n      ToastUtils.presentToast(\"Une erreur s'est produire lors de la modification de l'avatar\", \"danger\", this.toastController)\n    })\n\n  }\n\n  onValidate(){\n    let values = this.userForm.value\n\n    if(values.email.toLowerCase() == values.verifyEmail.toLowerCase()){\n      if(EmailUtils.verifyEmail(values.email)){\n        \n        this.user.email = values.email.toLowerCase()\n        this.user.address = values.address\n        this.user.phone = values.phone\n        // this.user.password = null\n        this.service.updateUser(this.user, this.token).subscribe((response) => {\n          console.log(response)\n          ToastUtils.presentToast(\"Informations modifées avec succès\", \"success\", this.toastController)\n\n          // mise à jour de l'utilisateur en sessionStorage\n          sessionStorage.setItem(\"User\", JSON.stringify(this.user))\n          \n          // retour en arrière\n          this.navController.pop()\n          \n        }, (error) => {\n          console.log(error)\n          ToastUtils.presentToast(\"Une erreur s'est produite\", \"danger\", this.toastController)\n        })\n\n      } else {\n        ToastUtils.presentToast(\"Veuillez saisir un email valide\", \"danger\", this.toastController)\n      }\n    } else {\n      ToastUtils.presentToast(\"Les emails ne sont pas identiques\", \"danger\", this.toastController)\n    }\n  }\n}","export default \"h1 {\\n  color: white;\\n  text-align: center;\\n}\\n\\nion-label {\\n  font-size: large;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2VkaXQtdXNlci5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBSUE7RUFDSSxZQUFBO0VBQ0Esa0JBQUE7QUFISjs7QUFNQTtFQUNJLGdCQUFBO0FBSEoiLCJmaWxlIjoiZWRpdC11c2VyLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIGlvbi1jb250ZW50e1xuLy8gICAgIC0tYmFja2dyb3VuZDogdXJsKFwiLi4vLi4vYXNzZXRzL2ltYWdlcy93YWxscGFwZXJcXCBjYWZldGVyaWEuanBnXCIpIG5vLXJlcGVhdCBjZW50ZXIgY2VudGVyIC8gY292ZXI7XG4vLyB9XG5cbmgxe1xuICAgIGNvbG9yOiB3aGl0ZTtcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG59XG5cbmlvbi1sYWJlbHtcbiAgICBmb250LXNpemU6IGxhcmdlO1xufSJdfQ== */\";","export default \"<ion-header>\\n  <app-header></app-header>\\n</ion-header>\\n\\n<ion-content>\\n\\n  <h1>Modifier les infos du compte</h1>\\n\\n  <form [formGroup]=\\\"userForm\\\" (ngSubmit)=\\\"onValidate()\\\" class=\\\"ion-margin-horizontal\\\" *ngIf=\\\"user\\\">\\n\\n    <ion-input type=\\\"file\\\" (change)=\\\"onImageUploaded($event)\\\" accept=\\\".png, .jpg, .jpeg\\\"></ion-input>\\n    <div class=\\\"ion-text-center\\\">\\n      <ion-button (click)=\\\"uploadImage()\\\" [disabled]=\\\"!this.isImageImported\\\" class=\\\"ion-margin-bottom\\\" color=\\\"primary\\\">Modifier avatar</ion-button>\\n    </div>\\n\\n    <ion-label class=\\\"ion-margin-bottom\\\" color=\\\"light\\\">Nom</ion-label>\\n    <ion-item class=\\\"ion-margin-bottom\\\">\\n      <ion-input color=\\\"medium\\\" type=\\\"text\\\" name=\\\"name\\\" readonly>{{user.name}}</ion-input>\\n    </ion-item>\\n\\n    <ion-label color=\\\"light\\\">Prénom</ion-label>\\n    <ion-item class=\\\"ion-margin-bottom\\\">\\n      <ion-input color=\\\"medium\\\" type=\\\"text\\\" name=\\\"firstname\\\" readonly>{{user.firstname}}</ion-input>\\n    </ion-item>\\n\\n    <ion-label color=\\\"light\\\">Email</ion-label>\\n    <ion-item class=\\\"ion-margin-bottom\\\">\\n      <ion-input type=\\\"email\\\" autocomplete=\\\"email\\\" formControlName=\\\"email\\\"></ion-input>\\n    </ion-item>\\n\\n    <ion-label color=\\\"light\\\">Vérifier email</ion-label>\\n    <ion-item class=\\\"ion-margin-bottom\\\">\\n      <ion-input type=\\\"email\\\" autocomplete=\\\"off\\\" formControlName=\\\"verifyEmail\\\"></ion-input>\\n    </ion-item>\\n\\n    <ion-label color=\\\"light\\\">Adresse</ion-label>\\n    <ion-item class=\\\"ion-margin-bottom\\\">\\n      <ion-input type=\\\"text\\\" formControlName=\\\"address\\\"></ion-input>\\n    </ion-item>\\n\\n    <ion-label color=\\\"light\\\">Tél.</ion-label>\\n    <ion-item class=\\\"ion-margin-bottom\\\">\\n      <ion-input type=\\\"phone\\\" formControlName=\\\"phone\\\"></ion-input>\\n    </ion-item>\\n    \\n    <div class=\\\"ion-text-center\\\">\\n      <ion-button [disabled]=\\\"!this.isValidateEnabled\\\" type=\\\"submit\\\" class=\\\"ion-margin-bottom\\\" color=\\\"primary\\\">Valider</ion-button>\\n    </div>\\n  </form>\\n\\n</ion-content>\";"],"sourceRoot":"webpack:///"}